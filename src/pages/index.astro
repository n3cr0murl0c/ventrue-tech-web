---
// Auto-detect visitor language based on IP geolocation
// Spanish-speaking countries list
const spanishCountries = [
  'ES', // Spain
  'MX', // Mexico
  'AR', // Argentina
  'CO', // Colombia
  'PE', // Peru
  'CL', // Chile
  'EC', // Ecuador
  'GT', // Guatemala
  'CU', // Cuba
  'BO', // Bolivia
  'DO', // Dominican Republic
  'SV', // El Salvador
  'HN', // Honduras
  'NI', // Nicaragua
  'PR', // Puerto Rico
  'PA', // Panama
  'UY', // Uruguay
  'PY', // Paraguay
  'GQ', // Equatorial Guinea
  'VE', // Venezuela
];
---

<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="refresh" content="0; url=/es/">
  <title>Redirecting...</title>
  <script is:inline>
    // Spanish-speaking countries
    const spanishCountries = ['ES', 'MX', 'AR', 'CO', 'PE', 'CL', 'EC', 'GT', 'CU', 'BO', 'DO', 'SV', 'HN', 'NI', 'PR', 'PA', 'UY', 'PY', 'GQ', 'VE'];
    
    async function detectLanguage() {
      try {
        // Try multiple geo-IP services
        let country = null;
        
        // Try ipapi.co (1000 requests/day free)
        try {
          const response = await fetch('https://ipapi.co/json/', { 
            timeout: 2000 
          });
          if (response.ok) {
            const data = await response.json();
            country = data.country_code;
          }
        } catch (e) {
          // Try next service
        }
        
        // Fallback to ipapi.com
        if (!country) {
          try {
            const response = await fetch('https://ipapi.com/json/?key=demo', { 
              timeout: 2000 
            });
            if (response.ok) {
              const data = await response.json();
              country = data.country_code;
            }
          } catch (e) {
            // Default to English if all fail
          }
        }
        
        // Redirect based on country
        if (country && spanishCountries.includes(country)) {
          window.location.href = '/es/';
        } else {
          window.location.href = '/en/';
        }
      } catch (e) {
        // Default to Spanish
        window.location.href = '/es/';
      }
    }
    
    // Start detection
    detectLanguage();
  </script>
</head>
<body>
  <p style="font-family: system-ui, sans-serif; text-align: center; padding: 50px;">
    Detecting your location...<br>
    <small>Detecting tu ubicaci√≥n...</small>
  </p>
</body>
</html>
